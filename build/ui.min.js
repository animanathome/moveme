'use strict';MMUI={Element:function(){}};MMUI.Element.prototype={setClass:function(a){this.dom.className=a;return this},setStyle:function(a,b){for(var c=0;c<b.length;c++)this.dom.style[a]=b[c]},setTextContent:function(a){this.dom.textContent=a;return this}};var properties="position left top right bottom width height border borderLeft borderTop borderRight borderBottom borderColor display overflow margin marginLeft marginTop marginRight marginBottom padding paddingLeft paddingTop paddingRight paddingBottom color backgroundColor opacity fontSize fontWeight textTransform cursor float".split(" ");
properties.forEach(function(a){var b="set"+a.substr(0,1).toUpperCase()+a.substr(1,a.length);MMUI.Element.prototype[b]=function(){this.setStyle(a,arguments);return this}});MMUI.Element.prototype.setId=function(a){this.dom.setAttribute("id",a);return this};MMUI.Element.prototype.setClass=function(a){this.dom.className=a;return this};MMUI.Element.prototype.addClass=function(a){this.dom.className=this.dom.className+" "+a;return this};var standardEvents="KeyUp KeyDown MouseOver MouseOut Click Start Change Finish Command".split(" ");
standardEvents.forEach(function(a){MMUI.Element.prototype["on"+a]=function(b){this.dom.addEventListener(a.toLowerCase(),b,!1);return this}});MMUI.Text=function(a){MMUI.Element.call(this);var b=document.createElement("span");b.className="Text";b.style.cursor="default";b.style.display="inline-block";b.style.verticalAlign="middle";this.dom=b;this.setValue(a);return this};MMUI.Text.prototype=Object.create(MMUI.Element.prototype);MMUI.Text.prototype.setValue=function(a){void 0!==a&&(this.dom.textContent=a);return this};MMUI.Input=function(){MMUI.Element.call(this);var a=document.createElement("input");a.className="Input";this.dom=a;return this};
MMUI.Input.prototype=Object.create(MMUI.Element.prototype);MMUI.Input.prototype.setValue=function(a){this.dom.value=a;return this};MMUI.Input.prototype.getValue=function(){return this.dom.value};MMUI.Text=function(a){MMUI.Element.call(this);var b=document.createElement("span");b.className="Text";this.dom=b;this.setValue(a);return this};MMUI.Text.prototype=Object.create(MMUI.Element.prototype);MMUI.Text.prototype.setValue=function(a){void 0!==a&&(this.dom.textContent=a);return this};
MMUI.Checkbox=function(a){MMUI.Element.call(this);var b=document.createElement("input");b.className="Checkbox";b.type="checkbox";this.dom=b;this.setValue(a);return this};MMUI.Checkbox.prototype=Object.create(MMUI.Element.prototype);MMUI.Checkbox.prototype.getValue=function(){return this.dom.checked};MMUI.Checkbox.prototype.setValue=function(a){void 0!==a&&(this.dom.checked=a);return this};
MMUI.Color=function(){MMUI.Element.call(this);var a=document.createElement("input");a.className="Color";a.style.backgroundColor="transparent";try{a.type="color"}catch(b){}this.dom=a;return this};MMUI.Color.prototype=Object.create(MMUI.Element.prototype);MMUI.Color.prototype.getValue=function(){return this.dom.value};MMUI.Color.prototype.getHexValue=function(){return parseInt(this.dom.value.substr(1),16)};
MMUI.Color.prototype.setValue=function(a){console.log("MMUI.Color.setValue",a);this.dom.value=a;return this};MMUI.Color.prototype.setHexValue=function(a){this.dom.value="#"+("000000"+a.toString(16)).slice(-6);return this};
MMUI.Number=function(a){MMUI.Element.call(this);var b=this,c=document.createElement("input");c.className="Number";c.value=0;this.startValue=c.value;c.startValue=this.startValue;this.dom=c;this.setValue(a);this.isMoving=!1;c.addEventListener("keydown",function(a){a.stopPropagation();13===a.keyCode&&(c.dispatchEvent(d),c.blur(),c.dispatchEvent(f))},!1);this.min=-Infinity;this.max=Infinity;this.precision=2;this.step=1;var d=document.createEvent("HTMLEvents");d.initEvent("start",!0,!0);var e=document.createEvent("HTMLEvents");
e.initEvent("change",!0,!0);var f=document.createEvent("HTMLEvents");f.initEvent("finish",!0,!0);var g=0,h=0,m=function(a){if(!1===this.isMoving||void 0===this.isMoving)c.dispatchEvent(d),this.isMoving=!1;var f=c.value;g+=(a.movementX||a.webkitMovementX||a.mozMovementX||0)-(a.movementY||a.webkitMovementY||a.mozMovementY||0);c.value=Math.min(b.max,Math.max(b.min,h+g/(a.shiftKey?5:50)*b.step)).toFixed(b.precision);f!==c.value&&c.dispatchEvent(e);this.isMoving=!0},k=function(a){console.log("onMouseUp");
document.removeEventListener("mousemove",m,!1);document.removeEventListener("mouseup",k,!1);2>Math.abs(g)&&c.select();g=0;c.dispatchEvent(f);c.style.cursor="default";this.isMoving=!1};c.addEventListener("change",function(a){a=parseFloat(c.value);!0===isNaN(a)&&(c.value=this.startValue)},!1);c.addEventListener("mousedown",function(a){console.log("Number onMouseDown");a.preventDefault();this.isMoving=!1;this.startValue=h=parseFloat(c.value);c.startValue=this.startValue;1===a.button&&(document.addEventListener("mousemove",
m,!1),c.style.cursor="col-resize");document.addEventListener("mouseup",k,!1)},!1);return this};MMUI.Number.prototype=Object.create(MMUI.Element.prototype);MMUI.Number.prototype.getStartValue=function(){return this.dom.startValue};MMUI.Number.prototype.getValue=function(){return parseFloat(this.dom.value)};MMUI.Number.prototype.setValue=function(a){void 0!==a&&(this.dom.value=a.toFixed(this.precision));return this};MMUI.Number.prototype.setRange=function(a,b){this.min=a;this.max=b;return this};
MMUI.Number.prototype.setPrecision=function(a){this.precision=a;return this};
MMUI.Integer=function(a){MMUI.Element.call(this);var b=this,c=document.createElement("input");c.className="Number";c.style.cursor="col-resize";c.value="0.00";c.addEventListener("keydown",function(a){a.stopPropagation()},!1);this.min=-Infinity;this.max=Infinity;this.step=1;this.prevValue=void 0;this.dom=c;this.setValue(a);var d=document.createEvent("HTMLEvents");d.initEvent("change",!0,!0);var e=0,f=0,g=function(a){var g=c.value;e+=(a.movementX||a.webkitMovementX||a.mozMovementX||0)-(a.movementY||
a.webkitMovementY||a.mozMovementY||0);c.value=Math.min(b.max,Math.max(b.min,f+e/(a.shiftKey?5:50)*b.step))|0;g!==c.value&&c.dispatchEvent(d)},h=function(a){document.removeEventListener("mousemove",g,!1);document.removeEventListener("mouseup",h,!1);2>Math.abs(e)&&c.select()};c.addEventListener("mousedown",function(a){a.preventDefault();e=0;f=parseFloat(c.value);document.addEventListener("mousemove",g,!1);document.addEventListener("mouseup",h,!1)},!1);c.addEventListener("change",function(a){console.log("onChange",
c.value);a=parseInt(c.value);!1===isNaN(a)?(c.value=a,b.prevValue=a):(console.log("\tIs not a number. Setting back previous value."),c.value=b.prevValue)},!1);return this};MMUI.Integer.prototype=Object.create(MMUI.Element.prototype);MMUI.Integer.prototype.getValue=function(){return parseInt(this.dom.value)};
MMUI.Integer.prototype.setValue=function(a){if(void 0===a)return console.log("\tIs undefined. Setting back previous value."),this.dom.value=this.prevValue,this;if(isNaN(a))return console.log("\tIs not a number. Setting back previous value."),this.dom.value=this.prevValue,this;this.dom.value=a|0;this.prevValue=this.dom.value;return this};MMUI.Integer.prototype.setRange=function(a,b){this.min=a;this.max=b;return this};
MMUI.ButtonToolBar=function(){MMUI.Element.call(this);var a=document.createElement("div");a.className="btn-toolbar";a.setAttribute("role","toolbar");this.dom=a;return this};MMUI.ButtonToolBar.prototype=Object.create(MMUI.Element.prototype);MMUI.ButtonToolBar.prototype.add=function(){for(var a=0;a<arguments.length;a++)this.dom.appendChild(arguments[a].dom);return this};
MMUI.ButtonGroup=function(){MMUI.Element.call(this);var a=document.createElement("div");a.className="btn-group";a.setAttribute("role","group");this.dom=a;return this};MMUI.ButtonGroup.prototype=Object.create(MMUI.Element.prototype);MMUI.ButtonGroup.prototype.add=function(){for(var a=0;a<arguments.length;a++)this.dom.appendChild(arguments[a].dom);return this};
MMUI.Button=function(a){MMUI.Element.call(this);var b=document.createElement("button");b.className="btn btn-default";this.dom=b;void 0!==a&&(this.dom.textContent=a);return this};MMUI.Button.prototype=Object.create(MMUI.Element.prototype);MMUI.Button.prototype.setLabel=function(a){this.dom.textContent=a;return this};MMUI.Button.prototype.setImage=function(a){this.dom.style.backgroundImage="url('"+a+"')";this.dom.className="btn btn-image btn-default";return this};
MMUI.Button.prototype.addGlyphicon=function(a){void 0===a&&(a="star");var b=document.createElement("span");b.className="glyphicon glyphicon-"+a;b.setAttribute("aria-hidden","true");this.dom.appendChild(b);return this};
MMUI.Button.prototype.addToolTip=function(a,b,c){void 0===b&&(b="top");void 0===c&&(c="400");this.dom.setAttribute("title",a);this.dom.setAttribute("data-placement",b);this.dom.setAttribute("data-delay",c);this.dom.setAttribute("data-container","body");this.dom.setAttribute("data-toggle","tooltip");return this};MMUI.A=function(a){MMUI.Element.call(this);var b=document.createElement("a");b.className="btn btn-default";this.dom=b;void 0!==a&&(this.dom.textContent=a);return this};MMUI.A.prototype=Object.create(MMUI.Element.prototype);
MMUI.A.prototype.setLabel=function(a){this.dom.textContent=a;return this};MMUI.A.prototype.setImage=function(a){this.dom.style.backgroundImage="url('"+a+"')";this.dom.className="btn btn-image btn-default";return this};MMUI.Panel=function(){MMUI.Element.call(this);var a=document.createElement("div");a.className="Panel";a.style.userSelect="none";this.dom=a;return this};MMUI.Panel.prototype=Object.create(MMUI.Element.prototype);MMUI.Panel.prototype.add=function(){for(var a=0;a<arguments.length;a++)this.dom.appendChild(arguments[a].dom);return this};
MMUI.CollapsiblePanel=function(){MMUI.Panel.call(this);this.setClass("panel collapsible");var a=this;this.static=new MMUI.Panel;this.static.setClass("static");this.static.onClick(function(){a.toggle()});this.dom.appendChild(this.static.dom);this.contents=new MMUI.Panel;this.contents.setClass("content");this.dom.appendChild(this.contents.dom);var b=new MMUI.Panel;b.setClass("button");this.static.add(b);this.isCollapsed=!1;return this};MMUI.CollapsiblePanel.prototype=Object.create(MMUI.Panel.prototype);
MMUI.CollapsiblePanel.prototype.addStatic=function(){this.static.add.apply(this.static,arguments);return this};MMUI.CollapsiblePanel.prototype.removeStatic=function(){this.static.remove.apply(this.static,arguments);return this};MMUI.CollapsiblePanel.prototype.clearStatic=function(){this.static.clear();return this};MMUI.CollapsiblePanel.prototype.add=function(){this.contents.add.apply(this.contents,arguments);return this};
MMUI.CollapsiblePanel.prototype.remove=function(){this.contents.remove.apply(this.contents,arguments);return this};MMUI.CollapsiblePanel.prototype.clear=function(){this.contents.clear();return this};MMUI.CollapsiblePanel.prototype.toggle=function(){this.setCollapsed(!this.isCollapsed)};MMUI.CollapsiblePanel.prototype.collapse=function(){this.setCollapsed(!0)};MMUI.CollapsiblePanel.prototype.expand=function(){this.setCollapsed(!1)};
MMUI.CollapsiblePanel.prototype.setCollapsed=function(a){a?this.dom.classList.add("collapsed"):this.dom.classList.remove("collapsed");this.isCollapsed=a;if(void 0!==this.onCollapsedChangeCallback)this.onCollapsedChangeCallback(a)};MMUI.CollapsiblePanel.prototype.onCollapsedChange=function(a){this.onCollapsedChangeCallback=a};MMUI.Timeline=function(){MMUI.Element.call(this);this.timeControlsWidth=230;var a=this,b=document.createElement("div");b.className="timeline";this.dom=b;this.time=18;this.startTime=2;this.endTime=24;this.keyframes=[1,2,6,12,18,24];this.uiElements={};this._end=this._start=-1;this._drag_selection=0;this._frame_width=-1;this._key_indices=[];this.bgFrameColor="#999";this.keyFrameColor="#900";this.timeFrameColor="#666";var c=new MMUI.Panel;c.setClass("timeline-content");c.setRight(this.timeControlsWidth+
"px");this.timeLine=c;b.appendChild(c.dom);c=new MMUI.Panel;c.setClass("timeline-controls");c.dom.style.width=this.timeControlsWidth+"px";b.appendChild(c.dom);b=(new MMUI.Panel).setFloat("left");b.dom.className="input-group";c.add(b);var d=(new MMUI.Integer(0)).setWidth("40px");d.onChange(function(){console.log("MM.timeline.onCurrentTime");a.time=a.currentTime.getValue();a.dom.dispatchEvent(a.timeChangeEvent)});d.dom.id="currentTime";d.dom.className="form-control";this.currentTime=d;b.add(d);b=(new MMUI.ButtonGroup).setPadding("4px");
c.add(b);c=new MMUI.Button;c.setLabel("|").addToolTip("Start Frame");c.onClick(function(){a.dom.dispatchEvent(a.startFrameEvent)});b.add(c);c=new MMUI.Button("|<");c.onClick(function(){a.dom.dispatchEvent(a.previousFrameEvent)}).addToolTip("Previous Key");b.add(c);var e=(new MMUI.Button(">")).setWidth("36px");e.onClick(function(){e.dom.textContent=">"===e.dom.textContent?"||":">";a.dom.dispatchEvent(a.playEvent)}).addToolTip("Play");b.add(e);c=new MMUI.Button(">|");c.onClick(function(){a.dom.dispatchEvent(a.nextFrameEvent)}).addToolTip("Next Key");
b.add(c);c=new MMUI.Button;c.setLabel("|");c.onClick(function(){a.dom.dispatchEvent(a.endFrameEvent)}).addToolTip("End Frame");b.add(c);this.playEvent=document.createEvent("HTMLEvents");this.playEvent.initEvent("play",!0,!0);this.startFrameEvent=document.createEvent("HTMLEvents");this.startFrameEvent.initEvent("startframe",!0,!0);this.previousFrameEvent=document.createEvent("HTMLEvents");this.previousFrameEvent.initEvent("previousframe",!0,!0);this.nextFrameEvent=document.createEvent("HTMLEvents");
this.nextFrameEvent.initEvent("nextframe",!0,!0);this.endFrameEvent=document.createEvent("HTMLEvents");this.endFrameEvent.initEvent("endframe",!0,!0);this.timeChangeEvent=document.createEvent("HTMLEvents");this.timeChangeEvent.initEvent("timechange",!0,!0);this.timeShiftEvent=document.createEvent("HTMLEvents");this.timeShiftEvent.initEvent("timeshift",!0,!0);this.timeReleaseEvent=document.createEvent("HTMLEvents");this.timeReleaseEvent.initEvent("timerelease",!0,!0);this.moveKeysEvent=document.createEvent("HTMLEvents");
this.moveKeysEvent.initEvent("movekeys",!0,!0);return this};MMUI.Timeline.prototype=Object.create(MMUI.Element.prototype);MMUI.Timeline.prototype.setActiveKeys=function(a){this.keyframes=a;this.update();return this};MMUI.Timeline.prototype.setTime=function(a){if(!isNaN(a))return this.time=a,this.update(),this};MMUI.Timeline.prototype.setRange=function(a,b){this.startTime=a;this.endTime=b;this.rebuild();return this};
MMUI.Timeline.prototype.update=function(){for(var a in this.uiElements.frame)this.uiElements.frame[a].style.backgroundColor=this.bgFrameColor;this.uiElements.frame.hasOwnProperty(this.time)&&(this.uiElements.frame[this.time].style.backgroundColor=this.timeFrameColor);this.currentTime.setValue(this.time);return this};MMUI.Timeline.prototype.clickTime=function(){var a=this;return function(b){a.setTime(parseInt(this.innerHTML));0==b.button&&a.dom.dispatchEvent(a.timeChangeEvent);1==b.button&&a.dom.dispatchEvent(a.timeShiftEvent)}};
MMUI.Timeline.prototype.dragSelection=function(){var a=this;return function(){var b=function(b){console.log("dragSelection.onMouseMove");b=b.movementX|b.webkitMovementX|b.mozMovementX|0;console.log("\tmove",b);a._drag_selection+=b;b=void 0;a._drag_selection>=a._frame_width&&(a._drag_selection=0,a._start+=1,a._end+=1,b=1);a._drag_selection<=-1*a._frame_width&&(a._drag_selection=0,--a._start,--a._end,b=-1);void 0!==b&&(a._updateSelection(),a._moveKeys(b),a._removeKeys(),a._buildKeys(),a.dom.dispatchEvent(a.moveKeysEvent))},
c=function(a){console.log("dragSelection.onMouseUp");console.log("\tevent",a);document.removeEventListener("mousemove",b);document.removeEventListener("mouseup",c)};document.addEventListener("mousemove",b,!1);document.addEventListener("mouseup",c,!1)}};
MMUI.Timeline.prototype.dragTime=function(){var a=this;return function(){var b=function(b){var c=parseInt(b.target.innerHTML);isNaN(c)||(!0===b.shiftKey?(-1===a._start?(a._start=c,console.log("_start",a._start)):(a._end=c,console.log("_end",a._end)),a._updateSelection(),a._getKeysWithinSelection()):(console.log("resetting"),a._start=-1,a._end=-1));a.setTime(c);0==b.button&&a.dom.dispatchEvent(a.timeChangeEvent);1==b.button&&a.dom.dispatchEvent(a.timeShiftEvent)},c=function(d){console.log("dragTime.onMouseUp");
console.log("\tevent",d);!1===d.shiftKey&&a._resetSelection();document.removeEventListener("mousemove",b);document.removeEventListener("mouseup",c);a.dom.dispatchEvent(a.timeReleaseEvent)};document.addEventListener("mousemove",b,!1);document.addEventListener("mouseup",c,!1)}};
MMUI.Timeline.prototype._updateSelection=function(){console.log("_updateSelection");if(-1!==this._start&&-1!==this._end){var a=this._start,b=this._end;this._start>this._end&&(a=this._end,b=this._start);console.log("\tindex start",a,"end",b);var a=parseInt(this.uiElements.frame[a].style.left),c=parseInt(this.uiElements.frame[b].style.left),c=c+parseInt(this.uiElements.frame[b].style.width);console.log("\tposition start",a,"end",c);b=this.uiElements.selection.style;b.display="block";b.left=a+"px";b.width=
c-a+2+"px"}};MMUI.Timeline.prototype._resetSelection=function(){console.log("_resetSelection");this._end=this._start=-1;this.uiElements.hasOwnProperty("selection")&&(this.uiElements.selection.style.display="none")};MMUI.Timeline.prototype._getKeysWithinSelection=function(){this._key_indices=[];var a,b;a=0;for(b=this.keyframes.length;a<b;a++)this.keyframes[a]>=this._start&&this.keyframes[a]<=this._end&&this._key_indices.push(a);console.log("\tkey indices:",this._key_indices)};
MMUI.Timeline.prototype._moveKeys=function(a){var b,c;b=0;for(c=this._key_indices.length;b<c;b++)this.keyframes[this._key_indices[b]]+=a};MMUI.Timeline.prototype._removeKeys=function(){for(var a in this.uiElements.key)console.log("\tkey",this.uiElements.key[a]),this.uiElements.key[a].parentNode.removeChild(this.uiElements.key[a])};
MMUI.Timeline.prototype._buildKeys=function(){this.uiElements.key={};var a,b,c;b=0;for(c=this.keyframes.length;b<c;b++)if(this.uiElements.bar.hasOwnProperty(this.keyframes[b])){a=parseInt(this.uiElements.bar[this.keyframes[b]].style.left);console.log("\tadding keyframe",this.keyframes[b]);var d=document.createElement("span");d.className="timeline-key";d.style.cssText="left:"+(a+2)+"px;";this.timeLine.dom.appendChild(d);this.uiElements.key[b]=d}};
MMUI.Timeline.prototype.rebuild=function(){for(this.uiElements={bar:{},frame:{},key:{}};this.timeLine.dom.firstChild;)this.timeLine.dom.removeChild(this.timeLine.dom.firstChild);var a=this.endTime-this.startTime+1,b=Math.floor(this.timeLine.dom.offsetWidth/a-1);this._frame_width=b;console.log("start",this.startTime);for(var c=this.startTime,d=0,e=0,f=b/2;this.timeLine.dom.children.length<2*a;){var e=f+d*(b+1),g=document.createElement("span");g.className="timeline-bar";g.style.cssText="left:"+e+"px;";
this.timeLine.dom.appendChild(g);this.uiElements.bar[c]=g;g=document.createElement("span");g.className="timeline-frame";g.style.cssText=this.time===c?"width:"+b+"px;left:"+(e+1)+"px;background-color:"+this.timeFrameColor:"width:"+b+"px;left:"+(e+1)+"px;background-color:"+this.bgFrameColor;g.addEventListener("mousedown",this.dragTime());g.addEventListener("click",this.clickTime());g.textContent=c;this.timeLine.dom.appendChild(g);this.uiElements.frame[c]=g;c+=1;d+=1}this._buildKeys();a=document.createElement("span");
a.className="timeline-key-selection";a.style.cssText="left:100px;width:100px;";this.timeLine.dom.appendChild(a);a.addEventListener("mousedown",this.dragSelection());this.uiElements.selection=a;return this};var events="Play Startframe Previousframe Nextframe Endframe Timechange Timeshift Movekeys Timerelease".split(" ");events.forEach(function(a){MMUI.Timeline.prototype["on"+a]=function(b){this.dom.addEventListener(a.toLowerCase(),b,!1);return this}});MMUI.RangeSlider=function(){MMUI.Element.call(this);var a=this;this.startTime=0;this.startRange=10;this.endRange=40;this.endTime=50;this.autoKey=!1;this.autoKeyColor="rgb(255, 111, 111)";var b=document.createElement("div");b.style.position="absolute";b.style.left="0px";b.style.right="0px";b.style.top="0px";b.style.bottom="0px";this.dom=b;b=new MMUI.Panel;b.setClass("rangeSlider");b.dom.style.position="absolute";b.dom.style.verticalAlign="middle";b.dom.style.left="0px";b.dom.style.right="0px";b.dom.style.top=
"0px";b.dom.style.bottom="0px";b.setBottom("0px");this.dom.appendChild(b.dom);var c=new MMUI.Panel;c.dom.style.position="absolute";c.dom.className="input-group";c.dom.style.top="0px";c.dom.style.left="5px";c.dom.style.width="100px";c.dom.style.bottom="0px";b.add(c);var d=new MMUI.Panel;d.setClass("rangeArea");d.dom.style.position="absolute";d.dom.style.margin="2px";d.dom.style.left="105px";d.dom.style.right="145px";d.dom.style.top="0px";d.dom.style.bottom="0px";d.dom.style.cursor="default";b.add(d);
this.rangeArea=d;var e=new MMUI.Integer(this.startTime);e.dom.className="form-control";e.dom.id="startTime";e.dom.style.width="40px";e.onChange(function(){a.startTime=e.getValue();a.check();a.objectToUI();e.setValue(a.startTime);a.dom.dispatchEvent(a.timeRangeChangeEvent)});c.dom.appendChild(e.dom);this.startTimeNumber=e;var f=new MMUI.Integer(this.startRange);f.dom.className="form-control";f.dom.id="startRangeNumber";f.dom.style.width="40px";f.onChange(function(){a.startRange=f.getValue();a.check();
a.objectToUI();f.setValue(a.startRange);a.dom.dispatchEvent(a.timeRangeChangeEvent)});c.dom.appendChild(f.dom);this.startRangeNumber=f;c=new MMUI.Panel;c.setClass("range");c.dom.style.position="absolute";c.dom.style.left="100px";c.dom.style.right="140px";c.dom.style.top="0px";c.dom.style.bottom="0px";c.dom.style.backgroundColor="#999";c.dom.style.cursor="move";d.dom.appendChild(c.dom);this.range=c;c.dom.addEventListener("mousedown",function(b){var c=function(b){b=b.movementX|b.webkitMovementX|b.mozMovementX|
0;var c=parseInt(String(a.range.dom.style.left).slice(0,-2)),d=parseInt(String(a.range.dom.style.right).slice(0,-2));-1<c+b&&-1<d-b&&(a.range.dom.style.left=c+b+"px",a.range.dom.style.right=d-b+"px",a.uiToObject(),a.dom.dispatchEvent(a.timeRangeChangeEvent))},d=function(a){document.removeEventListener("mousemove",c);document.removeEventListener("mouseup",d)};document.addEventListener("mousemove",c,!1);document.addEventListener("mouseup",d,!1)},!1);d=new MMUI.Panel;d.dom.style.position="absolute";
d.dom.style.width="15%";d.dom.style.height="100%";d.dom.style.left="0px";d.dom.style.cursor="w-resize";d.dom.addEventListener("mousedown",function(b){b.stopPropagation();var c=0,d=function(b){c=b.movementX|b.webkitMovementX|b.mozMovementX|0;b=parseInt(String(a.range.dom.style.left).slice(0,-2));-1<b+c&&(a.range.dom.style.left=b+c+"px",a.uiToObject(),a.dom.dispatchEvent(a.timeRangeChangeEvent))},e=function(a){document.removeEventListener("mousemove",d);document.removeEventListener("mouseup",e)};document.addEventListener("mousemove",
d,!1);document.addEventListener("mouseup",e,!1)},!1);c.dom.appendChild(d.dom);d=new MMUI.Panel;d.dom.style.position="absolute";d.dom.style.width="15%";d.dom.style.height="100%";d.dom.style.right="0px";d.dom.style.top="0px";d.dom.style.cursor="e-resize";d.dom.addEventListener("mousedown",function(b){b.stopPropagation();var c=0,d=function(b){c=b.movementX|b.webkitMovementX|b.mozMovementX|0;b=parseInt(String(a.range.dom.style.right).slice(0,-2));-1<b-c&&(a.range.dom.style.right=b-c+"px",a.uiToObject(),
a.dom.dispatchEvent(a.timeRangeChangeEvent))},e=function(a){document.removeEventListener("mousemove",d);document.removeEventListener("mouseup",e)};document.addEventListener("mousemove",d,!1);document.addEventListener("mouseup",e,!1)},!1);c.dom.appendChild(d.dom);c=new MMUI.Panel;c.dom.style.position="absolute";c.dom.className="input-group";c.dom.style.right="0px";c.dom.style.top="0px";c.dom.style.width="130px";c.dom.style.bottom="0px";b.add(c);var g=new MMUI.Integer(this.endRange);g.dom.id="endRangeNumber";
g.dom.className="form-control";g.setRight("0px");g.dom.style.width="40px";g.onChange(function(){a.endRange=g.getValue();a.check();a.objectToUI();g.setValue(a.endRange);a.dom.dispatchEvent(a.timeRangeChangeEvent)});c.dom.appendChild(g.dom);this.endRangeNumber=g;var h=new MMUI.Integer(this.endTime);h.dom.className="form-control";h.dom.id="endTime";h.dom.style.width="40px";h.onChange(function(){a.endTime=h.getValue();a.check();a.objectToUI();h.setValue(a.endTime);a.dom.dispatchEvent(a.timeRangeChangeEvent)});
c.dom.appendChild(h.dom);this.endTimeNumber=h;b=new MMUI.ButtonGroup;c.add(b);c=(new MMUI.Button).setImage("/ui/keyAuto.gif");c.onClick(function(){a.autoKey=a.autoKey?!1:!0;a.dom.dispatchEvent(a.autoKeyEvent);a.updateAutoKeyUI()}).addToolTip("Auto Key");b.add(c);this.autoKeyBtn=c;this.timeRangeChangeEvent=document.createEvent("HTMLEvents");this.timeRangeChangeEvent.initEvent("timerangechange",!0,!0);this.autoKeyEvent=document.createEvent("HTMLEvents");this.autoKeyEvent.initEvent("autokeychange",!0,
!0);this.updateAutoKeyUI();return this};MMUI.RangeSlider.prototype=Object.create(MMUI.Element.prototype);MMUI.RangeSlider.prototype.init=function(){this.objectToUI()};MMUI.RangeSlider.prototype.setAutoKey=function(a){this.autoKey=a;this.updateAutoKeyUI()};MMUI.RangeSlider.prototype.updateAutoKeyUI=function(){this.autoKey?this.autoKeyBtn.setBackgroundColor(this.autoKeyColor):this.autoKeyBtn.setBackgroundColor(null)};
MMUI.RangeSlider.prototype.check=function(){this.startRange<this.startTime&&(this.startRange=this.startTime);this.endRange>this.endTime&&(this.endRange=this.endTime)};
MMUI.RangeSlider.prototype.uiToObject=function(){var a=(this.endTime-this.startTime)/this.rangeArea.dom.offsetWidth;this.startRange=Math.floor(this.startTime+parseInt(String(this.range.dom.style.left).slice(0,-2))*a);this.endRange=Math.floor(this.endTime-parseInt(String(this.range.dom.style.right).slice(0,-2))*a);this.check();this.endRangeNumber.setValue(this.endRange);this.startRangeNumber.setValue(this.startRange)};
MMUI.RangeSlider.prototype.objectToUI=function(){var a=this.rangeArea.dom.offsetWidth/(this.endTime-this.startTime),b=Math.floor((this.endTime-this.endRange)*a);this.range.dom.style.left=Math.floor((this.startRange-this.startTime)*a)+"px";this.range.dom.style.right=b+"px"};
MMUI.RangeSlider.prototype.updateUI=function(){this.startTimeNumber.setValue(this.startTime);this.startRangeNumber.setValue(this.startRange);this.endRangeNumber.setValue(this.endRange);this.endTimeNumber.setValue(this.endTime);this.objectToUI()};MMUI.RangeSlider.prototype.setTime=function(a,b){this.startTime=a;this.endTime=b;this.updateUI()};MMUI.RangeSlider.prototype.setRange=function(a,b){this.startRange=a;this.endRange=b;this.updateUI()};var rs_events=["Timerangechange","Autokeychange"];
rs_events.forEach(function(a){MMUI.RangeSlider.prototype["on"+a]=function(b){this.dom.addEventListener(a.toLowerCase(),b,!1);return this}});MMUI.lineWithinRange=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]||a[0]===b[0]&&a[1]<=b[1]&&a[2]>=b[2]?!0:!1};
MMUI.PanelLayout=function(a,b){MMUI.Element.call(this,a,b);var c=document.createElement("div");c.style.top="0px";c.style.bottom="0px";c.style.left="0px";c.style.right="0px";c.style.position="absolute";this.dom=c;this.mdom=b;this.prefix="main";this.applyRandomColor=!0;this.setPanelClass=void 0;this.editor=a;this.sliderThickness=4;this.nPanels=0;this.panelName="view";this.newPanelName=void 0;this.canHidePanels=!1;this.layoutObject={panels:{infoLine:{h:[0,5],w:[0,80],td:["rangeSlider"],bd:[],rd:["sidebar"],
ld:[],dh:5,dw:80,v:!0},rangeSlider:{h:[5,15],w:[0,80],td:["timeLine"],bd:["infoLine"],rd:["sidebar"],ld:[],dh:10,dw:80,v:!0},timeLine:{h:[15,25],w:[0,80],td:["workspace"],bd:["rangeSlider"],rd:["sidebar"],ld:[],dh:10,dw:80,v:!0},workspace:{h:[25,100],w:[0,80],td:[],bd:["timeLine"],rd:["sidebar"],ld:[],dh:75,dw:80,v:!0},sidebar:{h:[0,100],w:[80,100],td:[],bd:[],rd:[],ld:["infoLine","rangeSlider","timeLine","workspace"],v:!0,dw:20}},hsliders:{infoLine:{h:[0,5],w:[20,80],td:["rangeSlider"],bd:["infoLine"]},
rangeSlider:{h:[5,15],w:[20,80],td:["timeLine"],bd:["rangeSlider"]},timeLine:{h:[15,25],w:[20,80],td:["workspace"],bd:["timeLine"]}},vsliders:{sidebar:{h:[0,100],w:[80,100],ld:["workspace","timeLine","infoLine","rangeSlider"],rd:["sidebar"]}}};this.layoutElements={};this.totalWidth=this.totalHeight=0;this.resizeLayoutEvent=document.createEvent("HTMLEvents");this.resizeLayoutEvent.initEvent("resizelayout",!0,!0);return this};MMUI.PanelLayout.prototype=Object.create(MMUI.Element.prototype);
MMUI.PanelLayout.prototype.getConnectedSliders=function(a,b){var c,d,e,f=["ld","rd","td","bd"],g=[];for(e in this.layoutObject[b])for(c=0;c<f.length;c++)if(d=this.layoutObject[b][e][f[c]],MM.arrayContainsAElementFromArray(d,a)){g.push(e);break}return g};
MMUI.PanelLayout.prototype.updateSliderConnections=function(a){var b,c,d,e,f;for(f in this.layoutObject[a]){b=this.layoutObject[a][f];"hsliders"===a?(b.td=[],b.bd=[],c=[b.h[1],b.w[0],b.w[1]]):(b.ld=[],b.rd=[],c=[b.w[0],b.h[0],b.h[1]]);for(var g in this.layoutObject.panels)if(d=this.layoutObject.panels[g],"hsliders"===a?(e=[d.h[0],d.w[0],d.w[1]],d=[d.h[1],d.w[0],d.w[1]]):(e=[d.w[0],d.h[0],d.h[1]],d=[d.w[1],d.h[0],d.h[1]]),MMUI.lineWithinRange(c,e)||MMUI.lineWithinRange(c,d))MMUI.lineWithinRange(c,
e)?"hsliders"===a?b.td.push(g):b.rd.push(g):"hsliders"===a?b.bd.push(g):b.ld.push(g)}};MMUI.PanelLayout.prototype.replaceDependencies=function(a,b,c,d){console.log("replaceDependencies",a,b,c,d);console.log("\tobj",this.layoutObject);var e,f,g;for(e=0;e<b.length;e++)for(g in this.layoutObject[a])f=this.layoutObject[a][g][b[e]].indexOf(c),-1!==f&&(console.log("\tupdating",g,b[e]),this.layoutObject[a][g][b[e]][f]=d)};
MMUI.PanelLayout.prototype.addDependencies=function(a,b,c,d){var e,f,g;for(e=0;e<b.length;e++)for(g in this.layoutObject[a])f=this.layoutObject[a][g][b[e]].indexOf(c),-1!==f&&this.layoutObject[a][g][b[e]].push(d)};MMUI.PanelLayout.prototype.removeDependencies=function(a,b,c){var d,e,f;for(d=0;d<b.length;d++)for(f in this.layoutObject[a])e=this.layoutObject[a][f][b[d]].indexOf(c),-1!==e&&this.layoutObject[a][f][b[d]].splice(e,1)};
MMUI.PanelLayout.prototype.getNeighourDirections=function(a){console.log("PanelLayout.getNeighourDirections",a);var b=["ld","rd","td","bd"];if(!this.layoutObject.panels.hasOwnProperty(a))return[];var c=this.layoutElements.container[a].dom,d=c.offsetHeight,c=c.offsetWidth,e=[],f,g,h;g=0;for(h=b.length;g<h;g++)f=this.layoutObject.panels[a][b[g]],0<f.length&&(console.log("\tneighbour",f[0]),f=this.layoutElements.container[f[0]].dom,f.offsetWidth!==c&&f.offsetHeight!==d||e.push(b[g]));return e};
MMUI.PanelLayout.prototype.getSlidersDriven=function(a,b,c){var d=["ld","rd","td","bd"],e,f,g=[];e=0;for(f=d.length;e<f;e++)this.layoutObject[a][b].hasOwnProperty(d[e])&&g.push.apply(g,this.layoutObject[a][b][d[e]]);a=g.indexOf(c);-1<a&&g.splice(a,1);return g};MMUI.PanelLayout.prototype.getDrivingSlider=function(a,b,c){for(var d in this.layoutObject[a])for(var e=0,f=b.length;e<f;e++)if(this.layoutObject[a][d].hasOwnProperty(b[e])&&-1!==this.layoutObject[a][d][b[e]].indexOf(c))return d};
MMUI.PanelLayout.prototype.getVisibleConnected=function(a,b,c,d,e){void 0===d&&(d=[]);e=void 0===e?0:e+1;if(10<e)console.log("\tERROR:LOOP");else{var f,g,h=[];if(this.layoutObject[a].hasOwnProperty(b)&&this.layoutObject[a][b].hasOwnProperty(c))for(h=this.layoutObject[a][b][c],f=0,g=h.length;f<g;f++)!0===this.layoutObject.panels[h[f]].v&&d.push(h[f]);if(0===d.length)for(f=0,g=h.length;f<g;f++)h[f]!==b&&this.getVisibleConnected(a,h[f],c,d,e);return d}};
MMUI.PanelLayout.prototype.resetLayout=function(){console.log("MMUI.PanelLayout.resetLayout");for(var a in this.layoutElements.container)console.log("\t",this.layoutElements.container[a]),a=this.layoutElements.container[a].dom,this.dom.removeChild(a);for(var b in this.layoutElements.hsliders)console.log("\t",this.layoutElements.hsliders[b]),b=this.layoutElements.hsliders[b].dom,this.dom.removeChild(b);for(b in this.layoutElements.vsliders)console.log("\t",this.layoutElements.vsliders[b]),b=this.layoutElements.vsliders[b].dom,
this.dom.removeChild(b)};
MMUI.PanelLayout.prototype.deletePanel=function(a,b){console.log("MMUI.PanelLayout.deletePanel",a,b);if(this.layoutElements.container.hasOwnProperty(a)){var c=this.layoutElements.container[a].dom;c.parentNode.removeChild(c);if("nd"!==b){var d,e,f,g,h;d=this.layoutObject.panels[a];e=d[b];for(c=0;c<e.length;c++){f=this.layoutObject.panels[e[c]];if("ld"===b||"rd"===b||"nd"===b)g=Math.min(f.w[0],d.w[0]),h=Math.max(f.w[1],d.w[1]),f.w=[g,h];if("td"===b||"bd"===b||"nd"===b)g=Math.min(f.h[0],d.h[0]),h=Math.max(f.h[1],
d.h[1]),f.h=[g,h];this.updateContainer(e[c])}}delete this.layoutElements.container[a];delete this.layoutObject.panels[a];this.removeDependencies("panels",["ld","rd","td","bd"],a)}if(c=this.getDrivingSlider("vsliders",["ld","rd"],a))d=this.getSlidersDriven("vsliders",c,a),1===d.length&&(d=this.layoutElements.vsliders[c].dom,d.parentNode.removeChild(d),delete this.layoutElements.vsliders[c],delete this.layoutObject.vsliders[c]);if(c=this.getDrivingSlider("hsliders",["ud","bd"],a))d=this.getSlidersDriven("hsliders",
c,a),1===d.length&&(d=this.layoutElements.hsliders[c].dom,d.parentNode.removeChild(d),delete this.layoutElements.hsliders[c],delete this.layoutObject.hsliders[c]);this.updateSliderConnections("hsliders");this.updateSliderConnections("vsliders");console.log("new layoutElements",this.layoutElements);console.log("new layoutObject",this.layoutObject);this.update(!0)};
MMUI.PanelLayout.prototype.getNextAvailablePanelName=function(){var a,b;for(a=0;100>a;a++)if(!this.layoutObject.panels.hasOwnProperty(this.panelName+a)){b=this.panelName+a;break}return b};
MMUI.PanelLayout.prototype.createSliderObjectBetween=function(a,b,c){console.log("createSliderObjectBetween",a,b,c);var d;switch(b){case "h":this.layoutObject.hasOwnProperty("hsliders")||(this.layoutObject.hsliders={});this.layoutObject.hsliders[a]={};d=this.layoutObject.hsliders[a];break;case "v":this.layoutObject.hasOwnProperty("vsliders")||(this.layoutObject.vsliders={}),this.layoutObject.vsliders[a]={},d=this.layoutObject.vsliders[a]}console.log("\tobj",d);var e;d.h=[];d.w=[];d.td=[];d.bd=[];
d.ld=[];d.rd=[];var f=[1E3,0],g=[1E3,0];for(a=0;a<c.length;a++)e=this.layoutObject.panels[c[a]],f[0]=Math.min(f[0],e.w[0]),f[1]=Math.max(f[1],e.w[1]),g[0]=Math.min(g[0],e.h[0]),g[1]=Math.max(g[1],e.h[1]);switch(b){case "h":d.w[0]=f[0];d.w[1]=f[1];d.h[0]=g[0];for(a=0;a<c.length;a++)if(e=this.layoutObject.panels[c[a]],e.h[0]!==g[0]&&e.h[0]!==g[1]){d.h[1]=e.h[0];break}d.td=[c[1]];d.bd=[c[0]];break;case "v":d.h[0]=g[0];d.h[1]=g[1];d.w[1]=f[1];for(a=0;a<c.length;a++)if(e=this.layoutObject.panels[c[a]],
e.w[0]!==f[0]&&e.w[0]!==f[1]){d.w[0]=e.w[0];break}d.ld=[c[0]];d.rd=[c[1]]}console.log("\t",d)};
MMUI.PanelLayout.prototype.createPanel=function(a,b){console.log("MMUI.PanelLayout.createPanel",a,b);console.log("\t",this.layoutObject);this.nPanels=Object.keys(this.layoutObject).length;console.log("\tnumber of panels",this.nPanels);if(this.layoutElements.container.hasOwnProperty(a)){var c=this.layoutObject.panels[a],d=c.w,e=c.h,f=c.td,g=c.bd,h=c.rd,m=c.ld,k,l,p,q,r,t,n=this.getNextAvailablePanelName();switch(b){case "h":k=d;l=[];l[0]=e[0];l[1]=(e[1]-e[0])/2+e[0];e[0]=(e[1]-e[0])/2+e[0];e[1]=e[1];
r=h;t=m;q=g;p=[a];g=[n];this.replaceDependencies("panels",["td"],a,n);break;case "v":l=e;k=[];k[0]=d[0];k[1]=(d[1]-d[0])/2+d[0];d[0]=(d[1]-d[0])/2+d[0];d[1]=d[1];p=f;q=g;r=[a];t=m;m=[n];this.replaceDependencies("panels",["rd"],a,n);break;default:console.log("Unsupported panel direction")}c.h=e;c.w=d;c.td=f;c.bd=g;c.rd=h;c.ld=m;c=this.layoutObject.panels[n]={};c.h=l;c.w=k;c.td=p;c.bd=q;c.rd=r;c.ld=t;c.v=!0;c.dh=l[1]-l[0];c.dw=k[1]-k[0];console.log("\tlayoutObject",this.layoutObject);console.log("\tlayoutElement",
this.layoutElements);this.updateContainer(a);this.createContainer(n);this.newPanelName=n;this.createSliderObjectBetween(n,b,[n,a]);switch(b){case "h":this.buildHSlider(n);break;case "v":this.buildVSlider(n)}this.updateSliderConnections("hsliders");this.updateSliderConnections("vsliders");this.update(!0)}else console.log("Unable to find panel with name",a)};
MMUI.PanelLayout.prototype.hidePanel=function(a){console.log("MMUI.PanelLayout.hidePanel",a);if(this.layoutElements.container.hasOwnProperty(a)){var b=this.layoutElements.container[a];console.log("\tcontainer");console.log("\t",b);var c=b.dom.offsetHeight+this.sliderThickness,d=b.dom.offsetWidth+this.sliderThickness;b.dom.style.display="none";this.layoutObject.panels[a].v=!1;console.log("\theight",c);console.log("\twidth",d);var e,f,g,b=this.getVisibleConnected("panels",a,"td");e=0;for(f=b.length;e<
f;e++)console.log("\tupdating height for",b[e]),g=this.layoutElements.container[b[e]].dom,e!==f-1&&(g.style.top=parseFloat(g.style.top)+c+"px"),g.style.bottom=parseFloat(g.style.bottom)-c+"px";var h=this.getVisibleConnected("panels",a,"ld");e=0;for(f=h.length;e<f;e++)console.log("\tupdating width for",h[e]),g=this.layoutElements.container[h[e]].dom,g.style.right=parseFloat(g.style.right)-d+"px";this.layoutElements.hsliders.hasOwnProperty(a)&&(d=this.layoutElements.hsliders[a],console.log("\thiding hslider"),
console.log("\t",d),d.dom.style.display="none");e=0;for(f=b.length;e<f;e++)this.layoutElements.hsliders.hasOwnProperty(b[e])&&(d=this.layoutElements.hsliders[b[e]].dom,d.style.top=parseFloat(d.style.top)+c+"px");this.layoutElements.vsliders.hasOwnProperty(a)&&(a=this.layoutElements.vsliders[a],console.log("\thiding vslider"),console.log("\t",a),a.dom.style.display="none");this.update()}else console.log("Unable to find panel with name",a)};
MMUI.PanelLayout.prototype.showPanel=function(a){console.log("MMUI.PanelLayout.showPanel",a);if(this.layoutElements.container.hasOwnProperty(a)){var b=this.layoutElements.container[a];b.dom.style.display="block";this.layoutObject.panels[a].v=!0;var c=b.dom.offsetHeight+this.sliderThickness,d=b.dom.offsetWidth+this.sliderThickness;console.log("\theight",c);console.log("\twidth",d);var b=this.getVisibleConnected("panels",a,"td"),e,f,g;e=0;for(f=b.length;e<f;e++)console.log("\tupdating",b[e]),g=this.layoutElements.container[b[e]].dom,
e!==f-1&&(g.style.top=parseFloat(g.style.top)-c+"px"),g.style.bottom=parseFloat(g.style.bottom)+c+"px";g=this.getVisibleConnected("panels",a,"ld");var h;e=0;for(f=g.length;e<f;e++)console.log("\tupdating width for",g[e]),h=this.layoutElements.container[g[e]].dom,h.style.right=parseFloat(h.style.right)+d+"px";this.layoutElements.hsliders.hasOwnProperty(a)&&(e=this.layoutElements.hsliders[a],console.log("\thslider"),console.log("\t",e),e.dom.style.display="block");e=0;for(f=b.length;e<f;e++)this.layoutElements.hsliders.hasOwnProperty(b[e])&&
(d=this.layoutElements.hsliders[b[e]].dom,d.style.top=parseFloat(d.style.top)-c+"px");this.layoutElements.vsliders.hasOwnProperty(a)&&(a=this.layoutElements.vsliders[a],console.log("\tshowing vslider"),console.log("\t",a),a.dom.style.display="block");this.update()}else console.log("Unable to find panel with name",a)};MMUI.PanelLayout.prototype.resize=function(){this.getDimensions();this.updateContainers();this.updateHSliders();this.updateVSliders();return this};
MMUI.PanelLayout.prototype.update=function(a){void 0===a&&(a=!1);!1===a&&this.updateLayoutObject();this.editor.signals.layoutResized.dispatch(this.prefix)};
MMUI.PanelLayout.prototype.updateLayoutObject=function(){console.log("updateLayoutObject");var a,b,c,d,e={},f;for(f in this.layoutElements.container)e[f]={h:[],w:[]},a=this.layoutElements.container[f],b=parseInt(parseFloat(a.dom.style.bottom)/this.totalHeight*100),c=parseFloat(a.dom.style.top),0<c&&(c-=this.sliderThickness),c=parseInt(100-c/this.totalHeight*100),d=parseFloat(a.dom.style.left),0<d&&(d-=this.sliderThickness),d=parseInt(d/this.totalWidth*100),a=parseInt(100-parseFloat(a.dom.style.right)/
this.totalWidth*100),e[f].h=[b,c],e[f].w=[d,a];var g;for(f in this.layoutElements.container)for(g in this.layoutElements.container)f!==g&&(b=e[f].w[1]-e[g].w[0],0<b&&4>b&&(e[g].w[0]=e[f].w[1]),b=e[f].h[1]-e[g].h[0],0<b&&4>b&&(e[g].h[0]=e[f].h[1]));for(f in this.layoutElements.container)this.layoutObject.panels[f].h=e[f].h,this.layoutObject.panels[f].w=e[f].w;var h,m;for(f in this.layoutObject.hsliders){c=a=1E3;m=d=0;h=this.layoutObject.hsliders[f];g=0;for(b=h.bd.length;g<b;g++)e=this.layoutObject.panels[h.bd[g]],
a=Math.min(a,e.w[0]),d=Math.max(d,e.w[1]),c=e.h[0],m=e.h[1];h.w=[a,d];h.h=[c,m]}for(f in this.layoutObject.vsliders){c=a=1E3;m=d=0;h=this.layoutObject.vsliders[f];g=0;for(b=h.rd.length;g<b;g++)e=this.layoutObject.panels[h.rd[g]],c=Math.min(c,e.h[0]),m=Math.max(m,e.h[1]),a=e.w[0],d=e.w[1];h.w=[a,d];h.h=[c,m]}};MMUI.PanelLayout.prototype.setPrefix=function(a){this.prefix=a;return this};MMUI.PanelLayout.prototype.setLayout=function(a){console.log("PanelLayout.setLayout",a);this.layoutObject=a;return this};
MMUI.PanelLayout.prototype.getRandomColor=function(){for(var a="0123456789ABCDEF".split(""),b="#",c=0;6>c;c++)b+=a[Math.floor(16*Math.random())];return b};MMUI.PanelLayout.prototype.getPixelPosition=function(a,b){var c=this.layoutObject[a[0]][a[1]][a[2]][b],c=c/100;0===this.totalWidth&&this.getDimensions();"h"===a[2]?(c*=this.totalHeight,1===b&&(c=this.totalHeight-c)):(c*=this.totalWidth,1===b&&(c=this.totalWidth-c));return c};
MMUI.PanelLayout.prototype.getDimensions=function(){this.totalHeight=this.dom.clientHeight;this.totalWidth=this.dom.clientWidth};MMUI.PanelLayout.prototype.showSlider=function(){return function(){this.style.backgroundColor="#00a989"}};MMUI.PanelLayout.prototype.hideSlider=function(){return function(){this.style.backgroundColor=""}};
MMUI.PanelLayout.prototype.moveVSlider=function(a,b,c){var d=this;return function(){console.log("moveVSlider",a,b,c);var e=function(c){c=c.movementX|c.webkitMovementX|c.mozMovementX|0;var e=b.vsliders[a].dom,f=parseFloat(e.style.left);e.style.left=f+c+"px";for(var k=d.getVisibleConnected("vsliders",a,"rd"),e=0,f=k.length;e<f;e++){var l=d.layoutElements.container[k[e]].dom;l.style.left=parseFloat(l.style.left)+c+"px"}k=d.getConnectedSliders(k,"hsliders");e=0;for(f=k.length;e<f;e++)l=d.layoutElements.hsliders[k[e]].dom,
l.style.left=parseFloat(l.style.left)+c+"px";k=d.getVisibleConnected("vsliders",a,"ld");e=0;for(f=k.length;e<f;e++)l=d.layoutElements.container[k[e]].dom,l.style.right=parseFloat(l.style.right)-c+"px";k=d.getConnectedSliders(k,"hsliders");e=0;for(f=k.length;e<f;e++)l=d.layoutElements.hsliders[k[e]].dom,l.style.right=parseFloat(l.style.right)-c+"px";d.update()},f=function(a){document.removeEventListener("mousemove",e);document.removeEventListener("mouseup",f)};document.addEventListener("mousemove",
e,!1);document.addEventListener("mouseup",f,!1)}};MMUI.PanelLayout.prototype.getPanel=function(a){if(this.layoutElements.hasOwnProperty("container")&&this.layoutElements.container.hasOwnProperty(a))return this.layoutElements.container[a]};var getElementInfo=function(a){var b=[];-1<a.indexOf("slider")?b=[a.split("-")[0],a.split("-")[1]]:(b.push("container"),b.push(a));return b};
MMUI.PanelLayout.prototype.moveHSlider=function(a,b,c){var d=this;return function(){var c=function(c){c=c.movementY|c.webkitMovementY|c.mozMovementY|0;var e=b.hsliders[a].dom,f=parseFloat(e.style.top);e.style.top=f+c+"px";for(var k=d.getVisibleConnected("hsliders",a,"bd"),e=0,f=k.length;e<f;e++){var l=d.layoutElements.container[k[e]].dom;l.style.top=parseFloat(l.style.top)+c+"px"}k=d.getVisibleConnected("hsliders",a,"td");e=0;for(f=k.length;e<f;e++)l=d.layoutElements.container[k[e]].dom,l.style.bottom=
parseFloat(l.style.bottom)-c+"px";d.update()},f=function(a){document.removeEventListener("mousemove",c);document.removeEventListener("mouseup",f)};document.addEventListener("mousemove",c,!1);document.addEventListener("mouseup",f,!1)}};MMUI.PanelLayout.prototype.panelCount=function(){return Object.keys(this.layoutElements.container).length};
MMUI.PanelLayout.prototype.createContainer=function(a){if(this.layoutElements.container.hasOwnProperty(a))console.log("PanelLayout already has an element named",a);else{var b,c=new MMUI.Panel;c.dom.id=this.prefix+_.str.classify(a)+"Container";c.setPosition("absolute");c.dom.style.bottom=this.getPixelPosition(["panels",a,"h"],0)+"px";b=this.getPixelPosition(["panels",a,"h"],1);0<b&&(b+=this.sliderThickness);c.dom.style.top=b+"px";b=this.getPixelPosition(["panels",a,"w"],0);0<b&&(b+=this.sliderThickness);
c.dom.style.left=b+"px";c.dom.style.right=this.getPixelPosition(["panels",a,"w"],1)+"px";this.applyRandomColor&&c.setBackgroundColor(this.getRandomColor());void 0!==this.setPanelClass&&c.setClass(this.setPanelClass+" "+this.setPanelClass+"-"+a);this.dom.appendChild(c.dom);this.layoutElements.container[a]=c}};MMUI.PanelLayout.prototype.buildContainers=function(){this.layoutElements.container={};for(var a in this.layoutObject.panels)this.createContainer(a)};
MMUI.PanelLayout.prototype.updateContainer=function(a){var b=this.layoutElements.container[a].dom.style;b.bottom=this.getPixelPosition(["panels",a,"h"],0)+"px";var c=this.getPixelPosition(["panels",a,"h"],1);0<c&&(c+=this.sliderThickness);b.top=c+"px";c=this.getPixelPosition(["panels",a,"w"],0);0<c&&(c+=this.sliderThickness);b.left=c+"px";b.right=this.getPixelPosition(["panels",a,"w"],1)+"px"};MMUI.PanelLayout.prototype.updateContainers=function(){for(var a in this.layoutElements.container)this.updateContainer(a)};
MMUI.PanelLayout.prototype.buildHSlider=function(a){console.log("buildHSlider",a);var b=new MMUI.Panel;b.dom.id=this.prefix+_.str.classify(a)+"HSlider";b.setPosition("absolute").setHeight(this.sliderThickness+"px");b.setTop(this.getPixelPosition(["hsliders",a,"h"],1)+"px");b.setLeft(this.getPixelPosition(["hsliders",a,"w"],0)+"px");b.setRight(this.getPixelPosition(["hsliders",a,"w"],1)+"px");b.dom.style.zIndex="10";this.dom.appendChild(b.dom);b.dom.addEventListener("mouseenter",this.showSlider());
b.dom.addEventListener("mouseout",this.hideSlider());b.dom.addEventListener("mousedown",this.moveHSlider(a,this.layoutElements,this.dom));this.layoutElements.hsliders[a]=b;this.layoutElements.hsliders[a].td=this.layoutObject.hsliders[a].td;this.layoutElements.hsliders[a].bd=this.layoutObject.hsliders[a].bd};MMUI.PanelLayout.prototype.buildHSliders=function(){this.layoutElements.hsliders={};for(var a in this.layoutObject.hsliders)this.buildHSlider(a)};
MMUI.PanelLayout.prototype.updateHSliders=function(){var a,b;for(b in this.layoutElements.hsliders)a=this.layoutElements.hsliders[b],a.setTop(this.getPixelPosition(["hsliders",b,"h"],1)+"px"),a.setLeft(this.getPixelPosition(["hsliders",b,"w"],0)+"px"),a.setRight(this.getPixelPosition(["hsliders",b,"w"],1)+"px")};
MMUI.PanelLayout.prototype.buildVSlider=function(a){var b=new MMUI.Panel;b.dom.id=this.prefix+_.str.classify(a)+"VSlider";b.setPosition("absolute").setWidth(this.sliderThickness+"px");b.setBottom(this.getPixelPosition(["vsliders",a,"h"],0)+"px");b.setTop(this.getPixelPosition(["vsliders",a,"h"],1)+"px");b.setLeft(this.getPixelPosition(["vsliders",a,"w"],0)+"px");b.dom.style.zIndex="10";this.dom.appendChild(b.dom);b.dom.addEventListener("mouseenter",this.showSlider());b.dom.addEventListener("mouseout",
this.hideSlider());b.dom.addEventListener("mousedown",this.moveVSlider(a,this.layoutElements,this.dom));this.layoutElements.vsliders[a]=b;this.layoutElements.vsliders[a].ld=this.layoutObject.vsliders[a].ld;this.layoutElements.vsliders[a].rd=this.layoutObject.vsliders[a].rd};MMUI.PanelLayout.prototype.buildVSliders=function(){this.layoutElements.vsliders={};for(var a in this.layoutObject.vsliders)this.buildVSlider(a)};
MMUI.PanelLayout.prototype.updateVSliders=function(){var a,b;for(b in this.layoutElements.vsliders)a=this.layoutElements.vsliders[b],a.setBottom(this.getPixelPosition(["vsliders",b,"h"],0)+"px"),a.setTop(this.getPixelPosition(["vsliders",b,"h"],1)+"px"),a.setLeft(this.getPixelPosition(["vsliders",b,"w"],0)+"px")};MMUI.PanelLayout.prototype.init=function(){console.log("MMUI PanelLayout: init");this.buildContainers();this.buildHSliders();this.buildVSliders()};var pl_events=["Resizelayout"];
pl_events.forEach(function(a){MMUI.PanelLayout.prototype["on"+a]=function(b){this.dom.addEventListener(a.toLowerCase(),b,!1);return this}});MMUI.Tab=function(){MMUI.Element.call(this);var a=this,b=document.createElement("div");b.className="tab-parent";this.width=void 0;this.dom=b;this.document=document;this.uiLabels={};this.labels=[];this.labelIcons=[];this.activeTab=void 0;var c=document.createEvent("HTMLEvents");c.initEvent("tabselect",!0,!0);b.addEventListener("mousedown",function(b){b.preventDefault();a.activeTab=b.target.value;a.update();a.dom.dispatchEvent(c)},!1);return this};MMUI.Tab.prototype=Object.create(MMUI.Element.prototype);
var tabEvents=["TabSelect"];tabEvents.forEach(function(a){MMUI.Tab.prototype["on"+a]=function(b){this.dom.addEventListener(a.toLowerCase(),b,!1);return this}});MMUI.Tab.prototype.setWidth=function(a){this.width=a};MMUI.Tab.prototype.addTab=function(a,b){this.labels.push(a);this.labelIcons.push(b)};
MMUI.Tab.prototype.build=function(){if(void 0!==this.width){var a=this.width/this.labels.length;this.activeTab=this.labels[0];for(var b=0,c=this.labels.length;b<c;b++){var d=document.createElement("div");d.className="tab-item";d.style.backgroundImage="url('"+this.labelIcons[b]+"')";d.value=this.labels[b];d.style.left=b*a+"px";d.style.width=a+"px";this.dom.appendChild(d);this.uiLabels[this.labels[b]]=d}this.update()}};
MMUI.Tab.prototype.update=function(){for(var a in this.uiLabels)this.uiLabels[a].className="tab-item";this.uiLabels[this.activeTab].className="tab-item tab-item-selected"};MMUI.GroupScrollList=function(){MMUI.Element.call(this);var a=this,b=document.createElement("div");b.className="groupscrolllist-panel";this.name="";this.dom=b;this.document=document;this.typeToDisplay=void 0;this.groups={};this.groupTypes={};this.maximized=[];this.psi=0;this.sGroups=[];this.sObjects=[];this.gOptions=[];this.oOptions={};this.oElements=[];this.selectedMenuItem=this.menu=void 0;this.menuItemTxts=[];var c=document.createEvent("HTMLEvents");c.initEvent("maximize",!0,!0);var d=document.createEvent("HTMLEvents");
d.initEvent("groupselect",!0,!0);var e=document.createEvent("HTMLEvents");e.initEvent("objectselect",!0,!0);var f=document.createEvent("HTMLEvents");f.initEvent("command",!0,!0);var g=function(a){console.log("GroupScrollList: onMouseMove")},h=function(b){console.log("GroupScrollList: onMouseUp");if(0===b.button){-1!==b.target.id.indexOf("$M")&&(a.setMaximizeGroupValue(b.target.value),a.dom.dispatchEvent(c));if(-1!==b.target.id.indexOf("$G")){var k="reset";!0===b.ctrlKey||!0===b.shiftKey?k="add":!0===
b.altKey&&(k="remove");a.selectGroup(b.target.value,k);a.dom.dispatchEvent(d)}if(-1!==b.target.id.indexOf("$O")){var l=parseFloat(b.target.getAttribute("gi")),k="reset";!0===b.ctrlKey?k="add":!0===b.shiftKey?k="addInbetween":!0===b.altKey&&(k="remove");a.selectObject(b.target.value,k,l);a.dom.dispatchEvent(e)}a.dom.removeEventListener("mousemove",g,!1);a.dom.removeEventListener("mouseup",h,!1)}else 2===b.button&&void 0!==a.menu&&(a.menu.setDisplay("none"),a.selectedMenuItem=b.target.textContent,a.dom.dispatchEvent(f),
a.dom.removeEventListener("mouseup",h,!1))};b.addEventListener("mousedown",function(c){c.preventDefault();0===c.button?(b.addEventListener("mousemove",g,!1),b.addEventListener("mouseup",h,!1)):2===c.button&&void 0!==a.menu&&(console.log("display",a.menu.dom.style.display),a.menu.setDisplay("block"),a.menu.dom.style.left=c.layerX+"px",a.menu.dom.style.top=c.layerY+"px",b.addEventListener("mouseup",h,!1))},!1);b.addEventListener("change",function(a){console.log("GroupScrollList: onChange")},!1);b.addEventListener("maximize",
function(b){console.log("GroupScrollList: onMaximize");a.updateUI()},!1);b.addEventListener("groupselect",function(b){console.log("GroupScrollList: onGroupSelect");a.updateUI()},!1);b.addEventListener("objectselect",function(b){console.log("GroupScrollList: onObjectSelect");a.updateUI()},!1);b.addEventListener("command",function(a){console.log("TextscrollList: onCommand")},!1);return this};MMUI.GroupScrollList.prototype=Object.create(MMUI.Element.prototype);
var additionalEvents=["Maximize","GroupSelect","ObjectSelect"];additionalEvents.forEach(function(a){MMUI.GroupScrollList.prototype["on"+a]=function(b){this.dom.addEventListener(a.toLowerCase(),b,!1);return this}});MMUI.GroupScrollList.prototype.clear=function(){this.removeAllFromUI();this.groups={};this.maximized=[];this.sObjects=[];this.sGroups=[]};
MMUI.GroupScrollList.prototype.addGroup=function(a,b){this.groups.hasOwnProperty(a)||("undefined"===b&&(b="asset"),this.groups[a]=[],this.groupTypes[a]=b,this.maximized[a]=!0)};MMUI.GroupScrollList.prototype.removeGroup=function(a){this.groups.hasOwnProperty(a)?(delete this.groups[a],delete this.groupTypes[a],delete this.maximized[a]):console.log("GroupScrollList does not contain group ",a,". Nothing to remove.")};
MMUI.GroupScrollList.prototype.hasGroup=function(a){return this.groups.hasOwnProperty(a)?!0:!1};MMUI.GroupScrollList.prototype.addObject=function(a,b){if(this.hasGroup(a)){if(-1==this.groups[a].indexOf(b))return this.groups[a].push(b),!0;console.log(b,"is already part of group",a)}return!1};MMUI.GroupScrollList.prototype.removeObject=function(a,b){if(this.hasGroup(a)){var c=this.groups[a].indexOf(b);-1!=c?this.groups[a].splice(c,1):console.log(b,"is not part of group",a,". Nothing to remove.")}};
MMUI.GroupScrollList.prototype.hasObject=function(a,b){return this.hasGroup(a)&&-1!=this.groups[a].indexOf(b)?!0:!1};MMUI.GroupScrollList.prototype.isGroupSelected=function(a){return-1!=this.sGroups.indexOf(a)?!0:!1};MMUI.GroupScrollList.prototype.isObjectSelected=function(a){return-1!=this.sObjects.indexOf(a)?!0:!1};
MMUI.GroupScrollList.prototype.addGroupToUI=function(a){var b=document.createElement("div");b.className="groupscrolllist-group";!0===this.isGroupSelected(a)&&(b.className="groupscrolllist-group groupscrolllist-group-selected");this.dom.appendChild(b);var c=document.createElement("div");c.className="groupscrolllist-group-min-max";c.value=a;c.id=a+"$M";c.innerHTML=1==this.maximized[a]?"-":"+";b.appendChild(c);c=document.createElement("div");c.className="groupscrolllist-group-name";c.value=a;c.innerHTML=
a;c.id=a+"$G";b.appendChild(c);this.gOptions.push(b)};MMUI.GroupScrollList.prototype.setMaximizeGroupValue=function(a){console.log("GroupScrollList: setMaximizeGroupValue",a);this.maximized[a]=!0===this.maximized[a]?!1:!0};
MMUI.GroupScrollList.prototype.addObjectToUI=function(a,b,c){var d=document.createElement("div");d.value=b;d.setAttribute("gi",c);d.id=b.name+"$O";d.className="groupscrolllist-object";d.innerHTML="&nbsp&nbsp&nbsp"+b.nattr;!0===this.isObjectSelected(b)&&(d.className="groupscrolllist-object groupscrolllist-object-selected");this.dom.appendChild(d);this.oOptions.hasOwnProperty(a)||(this.oOptions[a]=[]);this.oOptions[a].push(d);this.oElements[c]=b};
MMUI.GroupScrollList.prototype.selectGroup=function(a,b){void 0===b&&console.log("\tno mode defined. Defaulting to reset.");if("add"===b)this.sGroups.push(a);else if("remove"===b){var c=this.sGroups.indexOf(a,"to selection");this.sGroups.splice(c,1)}else this.sGroups=[],this.sObjects=[],this.sGroups.push(a);var d,e;d=0;for(e=this.groups[a].length;d<e;d++)c=this.sObjects.indexOf(this.groups[a][d]),-1!==c&&this.sObjects.splice(c,1)};
MMUI.GroupScrollList.prototype.selectObject=function(a,b,c){void 0===b&&console.log("\tno mode defined. Defaulting to reset.");if("add"===b)this.sObjects.push(a);else if("addInbetween"===b)if(0===this.sObjects.length)this.sObjects.push(a);else if(this.psi+1<c)for(b=this.psi+1;b<=c;b++)this.sObjects.push(this.oElements[b]);else for(b=c;b<=this.psi-1;b++)this.sObjects.push(this.oElements[b]);else if("remove"===b){var d=this.sObjects.indexOf(a,"to selection");this.sObjects.splice(d,1)}else this.sGroups=
[],this.sObjects=[],this.sObjects.push(a);this.psi=c;if(0<this.sGroups.length){var e,f;c=0;for(e=this.sGroups.length;c<e;c++)if(void 0!==this.groups[this.sGroups[c]])for(b=0,f=this.groups[this.sGroups[c]].length;b<f;b++)d=this.groups[this.sGroups[c]].indexOf(a),-1!==d&&this.sGroups.splice(d,1)}else console.log("No groups selected.")};
MMUI.GroupScrollList.prototype.removeAllFromUI=function(){for(;0<this.dom.children.length;)this.dom.removeChild(this.dom.firstChild);this.gOptions=[];this.oOptions={};this.oElements=[];return this};MMUI.GroupScrollList.prototype.addMenuItem=function(a){this.menuItemTxts.push(a);return this};
MMUI.GroupScrollList.prototype.addMenu=function(){var a=new MMUI.Panel;a.setClass("groupscrolllist-popup");this.dom.appendChild(a.dom);this.menu=a;var b,c,d;b=0;for(c=this.menuItemTxts.length;b<c;b++)d=new MMUI.Panel,d.setTextContent(this.menuItemTxts[b]),a.add(d)};MMUI.GroupScrollList.prototype.getSelectedObjects=function(){return this.sObjects};
MMUI.GroupScrollList.prototype.updateUI=function(){this.removeAllFromUI();var a=0,b;for(b in this.groups)if(void 0!==this.typeToDisplay){if(this.addGroupToUI(b),!0===this.maximized[b])for(var c=0;c<this.groups[b].length;c++)this.addObjectToUI(b,this.groups[b][c],a),a+=1}else if(this.groupTypes[b]===this.typeToDisplay&&(this.addGroupToUI(b),!0===this.maximized[b]))for(c=0;c<this.groups[b].length;c++)this.addObjectToUI(b,this.groups[b][c],a),a+=1;this.menu=void 0;this.addMenu()};MMUI.NavigationBar=function(){MMUI.Element.call(this);var a=document.createElement("nav");a.className="navbar navbar-default";this.dom=a};MMUI.NavigationBar.prototype=Object.create(MMUI.Element.prototype);MMUI.NavigationBar.prototype.add=function(){for(var a=0;a<arguments.length;a++)this.dom.appendChild(arguments[a].dom);return this};MMUI.Navigation=function(){MMUI.Element.call(this);var a=document.createElement("ul");a.className="nav nav-pills";this.dom=a;return this};MMUI.Navigation.prototype=Object.create(MMUI.Element.prototype);
MMUI.Navigation.prototype.add=function(){for(var a=0;a<arguments.length;a++)this.dom.appendChild(arguments[a].dom);return this};
MMUI.MenuGrp=function(a){MMUI.Element.call(this);var b=document.createElement("li");b.className="dropdown";this.dom=b;var c=document.createElement("a");c.className="dropdown-toggle";c.setAttribute("data-toggle","dropdown");c.textContent=a;b.appendChild(c);a=document.createElement("b");a.className="caret";c.appendChild(a);c=document.createElement("ul");c.className="dropdown-menu";b.appendChild(c);this.group=c;return this};MMUI.MenuGrp.prototype=Object.create(MMUI.Element.prototype);
MMUI.MenuGrp.prototype.add=function(){for(var a=0;a<arguments.length;a++)this.group.appendChild(arguments[a].dom);return this};MMUI.SubMenuGrp=function(a){MMUI.Element.call(this);var b=document.createElement("li");b.className="dropdown-submenu";this.dom=b;var c=document.createElement("a");c.textContent=a;b.appendChild(c);a=document.createElement("ul");a.className="dropdown-menu";b.appendChild(a);this.group=a;return this};MMUI.SubMenuGrp.prototype=Object.create(MMUI.MenuGrp.prototype);
MMUI.MenuGlyph=function(a){void 0===a&&(console.log("Warning, no glyphicon defined. Resetting to search"),a="search");MMUI.Element.call(this);var b=document.createElement("a");this.dom=b;var c=document.createElement("span");b.className="glyphicon glyphicon-"+a;b.appendChild(c);return this};MMUI.MenuGlyph.prototype=Object.create(MMUI.Element.prototype);MMUI.MenuGlyph.prototype.setLink=function(a){this.dom.href=a;return this};
MMUI.MenuLogo=function(a){MMUI.Element.call(this);var b=document.createElement("a");b.className="navbar-brand";this.dom=b;var c=document.createElement("img");c.setAttribute("alt","Brand");c.className="img-rounded";c.src=a;b.appendChild(c);this.img=c;return this};MMUI.MenuLogo.prototype=Object.create(MMUI.Element.prototype);MMUI.MenuLogo.prototype.setImageDimensions=function(a,b){this.img.style.width=a;this.img.style.height=b;return this};
MMUI.MenuLogo.prototype.setLink=function(a){this.dom.href=a;return this};MMUI.MenuItem=function(a){MMUI.Element.call(this);this.dom=document.createElement("li");var b=document.createElement("a");b.innerHTML=a;b.href="#";this.sdom=b;this.dom.appendChild(b);return this};MMUI.MenuItem.prototype=Object.create(MMUI.Element.prototype);MMUI.MenuItem.prototype.add=function(){for(var a=0;a<arguments.length;a++)this.dom.appendChild(arguments[a].dom);return this};
MMUI.MenuItem.prototype.addShortcut=function(a){var b=document.createElement("span");b.className="kbd text-muted anim-kbd";b.textContent=a;this.sdom.appendChild(b);return this};MMUI.MenuDivider=function(){MMUI.Element.call(this);var a=document.createElement("li");a.className="divider";this.dom=a;return this};MMUI.Select=function(){MMUI.Element.call(this);var a=document.createElement("select");a.className="Select";this.dom=a;return this};MMUI.Select.prototype=Object.create(MMUI.Element.prototype);MMUI.Select.prototype.setMultiple=function(a){this.dom.multiple=a;return this};
MMUI.Select.prototype.setOptions=function(a){for(var b=this.dom.value;0<this.dom.children.length;)this.dom.removeChild(this.dom.firstChild);for(var c in a){var d=document.createElement("option");d.value=c;d.innerHTML=a[c];this.dom.appendChild(d)}this.dom.value=b;return this};MMUI.Select.prototype.getValue=function(){return this.dom.value};MMUI.Select.prototype.setValue=function(a){console.log("MMUI.Select.setValue",a);this.dom.value=a;return this};MMUI.Select.prototype.getSelectedText=function(){return this.dom.options[this.dom.value].text};
MMUI.Select.prototype.setSelectedText=function(a){var b,c;b=0;for(c=this.dom.options.length;b<c;b++)if(this.dom.options[b].text===a){this.dom.value=b;break}};MMUI.Dropdown=function(a){MMUI.Element.call(this);var b=document.createElement("div");b.className="dropdown";this.dom=b;var c=document.createElement("button");c.className="btn btn-default dropdown-toggle";c.setAttribute("type","button");c.setAttribute("data-toggle","dropdown");c.innerHTML=a;this.dropbtn=c;b.appendChild(c);a=document.createElement("span");a.className="caret";c.appendChild(a);c=document.createElement("li");c.className="dropdown-menu";c.setAttribute("role","menu");b.appendChild(c);this.dropgrp=
c;return this};MMUI.Dropdown.prototype=Object.create(MMUI.Element.prototype);MMUI.Dropdown.prototype.add=function(){for(var a=0;a<arguments.length;a++)this.dropgrp.appendChild(arguments[a].dom);return this};MMUI.Dropdown.prototype.setTitle=function(a){this.dropbtn.innerHTML=a;return this};MMUI.Dropdown.prototype.removeAll=function(){for(;this.dropgrp.firstChild;)this.dropgrp.removeChild(this.dropgrp.firstChild);return this};
MMUI.DropdownItem=function(a){MMUI.Element.call(this);var b=document.createElement("li");b.setAttribute("role","presentation");this.dom=b;b=document.createElement("a");b.setAttribute("role","menuitem");b.setAttribute("tabIndex","-1");b.innerHTML=a;this.dom.appendChild(b);return this};MMUI.DropdownItem.prototype=Object.create(MMUI.Element.prototype);
MMUI.DropdownDivider=function(){MMUI.Element.call(this);var a=document.createElement("li");a.className="divider";a.setAttribute("role","presentation");this.dom=a;return this};MMUI.DropdownDivider.prototype=Object.create(MMUI.Element.prototype);MMUI.FloatGrp=function(a){MMUI.Element.call(this);var b=document.createElement("div");b.className="input-group";var c=this;this.dom=b;var d=document.createElement("span");d.className="input-group-addon";d.innerHTML=a;b.appendChild(d);var e=document.createElement("input");e.setAttribute("type","number");e.className="form-control";e.value=0;b.appendChild(e);this.input=e;this.startValue=e.value;this.isMoving=!1;e.addEventListener("keydown",function(a){a.stopPropagation();13===a.keyCode&&(b.dispatchEvent(f),
b.blur(),b.dispatchEvent(h))},!1);this.min=-Infinity;this.max=Infinity;this.precision=2;this.step=1;var f=document.createEvent("HTMLEvents");f.initEvent("start",!0,!0);var g=document.createEvent("HTMLEvents");g.initEvent("change",!0,!0);var h=document.createEvent("HTMLEvents");h.initEvent("finish",!0,!0);var m=0,k=0,l=function(a){if(!1===this.isMoving||void 0===this.isMoving)b.dispatchEvent(f),this.isMoving=!1;var d=e.value;m+=(a.movementX||a.webkitMovementX||a.mozMovementX||0)-(a.movementY||a.webkitMovementY||
a.mozMovementY||0);e.value=Math.min(c.max,Math.max(c.min,k+m/(a.shiftKey?5:50)*c.step)).toFixed(c.precision);d!==e.value&&b.dispatchEvent(g);this.isMoving=!0},p=function(a){console.log("onMouseUp");document.removeEventListener("mousemove",l,!1);document.removeEventListener("mouseup",p,!1);2>Math.abs(m)&&(e.focus(),e.select());m=0;b.dispatchEvent(h);this.isMoving=!1};e.addEventListener("change",function(a){a=parseFloat(e.value);!1===isNaN(a)&&(e.value=a)},!1);e.addEventListener("mousedown",function(a){console.log("Number onMouseDown");
a.preventDefault();this.isMoving=!1;this.startValue=k=parseFloat(e.value);e.startValue=this.startValue;document.addEventListener("mouseup",p,!1);document.addEventListener("mousemove",l,!1)},!1);return this};MMUI.FloatGrp.prototype=Object.create(MMUI.Element.prototype);MMUI.FloatGrp.prototype.getStartValue=function(){return this.input.startValue};MMUI.FloatGrp.prototype.getValue=function(){return parseFloat(this.input.value)};
MMUI.FloatGrp.prototype.setValue=function(a){void 0!==a&&(this.input.value=a.toFixed(this.precision));return this};MMUI.FloatGrp.prototype.setRange=function(a,b){this.min=a;this.max=b;return this};MMUI.FloatGrp.prototype.setPrecision=function(a){this.precision=a;return this};MMUI.Dialog=function(a,b,c){MMUI.Element.call(this);var d=this,e=document.createElement("div");e.className="modal";this.dom=e;var f=document.createElement("div");f.className="modal-dialog";e.appendChild(f);e=document.createElement("div");e.className="modal-content";f.appendChild(e);f=document.createElement("div");f.className="modal-header";e.appendChild(f);var g=document.createElement("button");g.setAttribute("type","button");g.className="close";g.setAttribute("data-dismiss","modal");g.setAttribute("aria-label",
"Close");f.appendChild(g);g.onclick=function(){d.hide()};var h=document.createElement("span");h.setAttribute("aria-hidden","true");h.innerHTML="x";g.appendChild(h);g=document.createElement("h4");g.className="modal-title";g.innerHTML=a;f.appendChild(g);a=document.createElement("div");a.className="modal-body";e.appendChild(a);f=document.createElement("textarea");f.className="form-control";f.setAttribute("rows","5");f.setAttribute("id","message-text");f.setAttribute("placeholder",b);a.appendChild(f);
this.body=f;b=document.createElement("div");b.className="modal-footer";e.appendChild(b);e=document.createElement("button");e.className="btn btn-default";e.setAttribute("data-dismiss","modal");e.setAttribute("type","button");e.innerHTML="Close";b.appendChild(e);e.onclick=function(){d.hide()};e=document.createElement("button");e.className="btn btn-default";e.setAttribute("type","button");e.innerHTML=c;b.appendChild(e);e.onclick=function(){d.onAction()};return this};MMUI.Dialog.prototype=Object.create(MMUI.Element.prototype);
MMUI.Dialog.prototype.hide=function(){this.dom.style.display="none";return this};MMUI.Dialog.prototype.show=function(){this.dom.style.display="block";return this};MMUI.Dialog.prototype.getValue=function(){return this.body.value};MMUI.Dialog.prototype.onAction=function(){return this};MMUI.Dialog.prototype.deleteUI=function(){this.dom.parentNode.removeChild(this.dom)};
MMUI.VideoDialog=function(a,b,c){MMUI.Element.call(this);var d=this,e=document.createElement("div");this.dom=e;c=document.createElement("div");c.className="embed-responsive embed-responsive-16by9";e.appendChild(c);e=document.createElement("iframe");e.className="embed-responsive-item";b="https://www.youtube.com/embed/"+b+"?"+("loop=1&playlist="+b);b+="&autoplay=1";b+="&fs=0";b+="&showinfo=0";b+="&enablejsapi=1";b+="&modestbranding";b+="&controls=0";e.src=b;c.appendChild(e);b=document.createElement("div");
b.className="video-banner-content";c.appendChild(b);c=document.createElement("span");c.className="video-banner-title";c.textContent=a;b.appendChild(c);a=document.createElement("button");a.setAttribute("type","button");a.className="close";a.setAttribute("data-dismiss","modal");a.setAttribute("aria-label","Close");a.onclick=function(){d.deleteUI()};b.appendChild(a);c=document.createElement("span");c.setAttribute("aria-hidden","true");c.style.padding="5px";c.innerHTML="x";a.appendChild(c);return this};
MMUI.VideoDialog.prototype=Object.create(MMUI.Element.prototype);MMUI.VideoDialog.prototype.deleteUI=function(){this.dom.parentNode.removeChild(this.dom)};
MMUI.MessageDialog=function(a,b){var c=document.createElement("div");c.className="modal";this.dom=c;var d=document.createElement("div");d.className="modal-dialog";c.appendChild(d);var e=document.createElement("div");e.className="modal-content";d.appendChild(e);d=document.createElement("div");d.className="modal-header";e.appendChild(d);this.header=d;var f=document.createElement("button");f.setAttribute("type","button");f.className="close";f.setAttribute("data-dismiss","modal");f.setAttribute("aria-label",
"Close");d.appendChild(f);f.onclick=function(){c.parentNode.removeChild(c)};var g=document.createElement("span");g.setAttribute("aria-hidden","true");g.innerHTML="x";f.appendChild(g);f=document.createElement("h4");f.className="modal-title";f.innerHTML=a;d.appendChild(f);d=document.createElement("div");d.className="modal-body";d.textContent=b;e.appendChild(d);d=document.createElement("div");d.className="modal-footer";e.appendChild(d);e=document.createElement("button");e.className="btn btn-default";
e.setAttribute("data-dismiss","modal");e.setAttribute("type","button");e.innerHTML="OK";d.appendChild(e);e.onclick=function(){c.parentNode.removeChild(c)};return this};
